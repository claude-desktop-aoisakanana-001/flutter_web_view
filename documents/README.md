# プロジェクトドキュメント - 小説家になろうリーダーアプリ

**最終更新**: 2025-11-30
**プロジェクトステータス**: 設計完了、実装準備中

---

## 📚 ドキュメント一覧

このディレクトリには、小説家になろうリーダーアプリのMVP開発に関する設計ドキュメントが格納されています。

| ドキュメント | 概要 | 対象読者 |
|------------|------|---------|
| **[mvp-requirements.md](./mvp-requirements.md)** | MVP要件定義書 | 全員 |
| **[tech-selection.md](./tech-selection.md)** | 技術選定書 | 開発者 |
| **[architecture.md](./architecture.md)** | アーキテクチャ設計書 | 開発者 |
| **[issue-plan.md](./issue-plan.md)** | Issue計画書 | プロジェクトマネージャー、開発者 |
| **README.md（本ファイル）** | プロジェクトサマリ | 全員 |

---

## 🎯 プロジェクト概要

### プロジェクト名
**小説家になろうリーダーアプリ**（yomiagerun_app）

### 目的
「小説家になろう」の閲覧体験を拡張し、自動読み上げ機能を提供するモバイルアプリを開発する。

### ビジョン
将来的には「小説家になろう」公式パートナーとなることを視野に入れる。

### 対象プラットフォーム
- **初期リリース**: iOS
- **将来展開**: Android

---

## 🎨 MVP必須機能

### 1. 小説閲覧機能
- 「小説家になろう」の小説ページからHTMLを取得
- HTML解析により本文を抽出・表示

### 2. 自動読み上げ機能
- 抽出した本文をTTS（Text-to-Speech）で読み上げ
- 読み上げ中の文章をハイライト表示
- 読み上げ位置に合わせた自動スクロール

### 3. 読み上げ制御
- 再生/一時停止/停止のコントローラー
- 読み上げ速度の調整機能

---

## 🛠 技術スタック

### コア技術
- **フレームワーク**: Flutter 3.10.0+
- **言語**: Dart 3.0.0+
- **状態管理**: Riverpod 2.4.0+

### 主要パッケージ
| パッケージ | 用途 |
|-----------|------|
| `flutter_riverpod` | 状態管理 |
| `flutter_tts` | テキスト読み上げ |
| `http` | HTTP通信 |
| `html` | HTML解析 |
| `freezed` | 不変データモデル生成 |
| `riverpod_generator` | Providerコード生成 |

詳細は **[tech-selection.md](./tech-selection.md)** を参照。

---

## 🏗 アーキテクチャ

### レイヤー構成
**レイヤードアーキテクチャ + Feature-First構成**

```
lib/
├── app/                  # アプリケーション層
├── features/            # 機能別ディレクトリ
│   ├── novel_reader/   # 小説閲覧・読み上げ
│   ├── tts/            # TTS機能
│   └── html_parser/    # HTML解析
└── shared/             # 共通コンポーネント
```

### 主要な設計原則
1. **シンプルさ優先**: 過度な抽象化を避ける
2. **小説家になろう専用**: 汎用性より最適化を優先
3. **自然な拡張性**: 過度な設計はしないが、自然な拡張は許容
4. **テスト容易性**: Riverpod による依存性注入

詳細は **[architecture.md](./architecture.md)** を参照。

---

## 📋 Issue構成

### 全体構成
**合計11 Issues、4 Phases**

| Phase | Issues | 概要 | 見積もり |
|-------|--------|------|---------|
| Phase 1 | #1〜#4 | 基盤構築 | 6.5時間 |
| Phase 2 | #5〜#7 | TTS機能実装 | 6時間 |
| Phase 3 | #8〜#10 | UI統合・ハイライト | 7時間 |
| Phase 4 | #11 | 総合テスト | 3時間 |
| **合計** | **11 Issues** | - | **22.5時間** |

### Phase 1: 基盤構築
- **Issue #1**: プロジェクトセットアップと依存関係追加
- **Issue #2**: 「小説家になろう」HTML構造の調査 ⭐
- **Issue #3**: HTML解析機能の実装
- **Issue #4**: 基本的なアプリ構造とルーティング

### Phase 2: TTS機能実装
- **Issue #5**: TTS基本機能の実装
- **Issue #6**: 読み上げ速度設定UI
- **Issue #7**: 再生コントローラーUI

### Phase 3: UI統合とハイライト機能
- **Issue #8**: 小説本文表示UIとデータ統合
- **Issue #9**: 読み上げ位置のハイライト表示機能 ⭐
- **Issue #10**: 読み上げ位置の自動スクロール機能 ⭐

### Phase 4: 総合テストと調整
- **Issue #11**: MVPの総合テストと最終調整

⭐ = ユーザーフィードバックにより追加された重要Issue

詳細は **[issue-plan.md](./issue-plan.md)** を参照。

---

## 🔑 重要な設計決定

### 1. WebView vs HTTP直接取得
**決定**: HTTP直接取得（Option B）を採用

**理由**:
- シンプルで信頼性が高い
- パフォーマンスが良い
- デバッグしやすい

### 2. ハイライト表示と自動スクロール
**決定**: MVP範囲に含める

**実装方法**:
- ハイライト: RichText + TextSpan
- 自動スクロール: ScrollController + animateTo

### 3. TTS設定の拡張性
**決定**: TTSConfigモデルで将来の拡張に対応

```dart
class TTSConfig {
  double speed;              // MVP対応
  double pitch;              // 将来対応
  double volume;             // 将来対応
  double linePause;          // 将来対応（行間の間隔）
  double paragraphPause;     // 将来対応（段落間の間隔）
}
```

---

## 📊 データフロー

```
小説URL
    ↓
HTTP GET（httpパッケージ）
    ↓
HTML取得
    ↓
HTML解析（htmlパッケージ）
    ↓
本文テキスト抽出
    ↓
NovelContentモデル
    ↓
TTSService（flutter_tts）
    ↓
読み上げ + ハイライト + 自動スクロール
    ↓
PlaybackController（UI制御）
```

---

## 🚀 開始方法

### 新しい開発者がプロジェクトに参加する場合

1. **まず読むべきドキュメント**:
   - このREADME.md（全体像の把握）
   - [mvp-requirements.md](./mvp-requirements.md)（要件の理解）

2. **実装を開始する前に読むべきドキュメント**:
   - [tech-selection.md](./tech-selection.md)（技術選定の背景）
   - [architecture.md](./architecture.md)（設計の詳細）
   - [issue-plan.md](./issue-plan.md)（実装計画）

3. **Issue作業時**:
   - [issue-plan.md](./issue-plan.md) で担当Issueの詳細を確認
   - [architecture.md](./architecture.md) で関連する設計を確認
   - CLAUDE.md のGitワークフローに従って作業

---

## ✅ 成功基準

### 機能的成功基準
- [ ] 小説本文を正しく抽出できる
- [ ] TTSで本文を読み上げられる
- [ ] 読み上げ速度を変更できる
- [ ] 再生/一時停止/停止が正常に動作する
- [ ] 読み上げ位置がハイライトされる
- [ ] 自動スクロールが動作する

### 技術的成功基準
- [ ] すべてのテストが成功
- [ ] `flutter analyze` でエラーなし
- [ ] iOS実機でビルド・実行可能
- [ ] クラッシュなく30分以上連続稼働

---

## 🔒 開発制約

### Git運用ルール
- **git push 禁止**: 指定されたブランチのみ使用
- **Issue ごとにブランチ作成**: feature/issue-{番号}-{説明}
- **Issue着手時にコメント**: 実施計画を記載
- **作業完了時にコメント**: 実施内容を報告

詳細は **CLAUDE.md** を参照。

### 実装前の合意
- コードを書く前に設計を議論
- 決定事項は `documents/` 配下にmarkdownで保存

### プログラム実行
- 実行前に許可を得る
- テスト実行も含む

---

## 📈 今後の展開

### MVP範囲外の機能（将来検討）
- しおり機能
- お気に入り登録
- 読書履歴
- オフライン読書
- バックグラウンド再生
- 音声の詳細設定（音量、ピッチなど）
- ユーザーアカウント連携
- マルチデバイス同期

### プラットフォーム展開
- Android対応
- Webアプリ化（検討）

---

## 📝 変更管理

### ドキュメントの更新
- 設計変更があった場合は該当するドキュメントを更新
- 変更履歴セクションに記録を残す
- バージョン番号を更新

### 承認プロセス
- すべての設計ドキュメントはユーザー承認が必要
- 承認日を記録

---

## 🤝 他のClaude Codeへのメッセージ

このプロジェクトを引き継ぐClaude Codeへ：

1. **必ず最初にこのREADME.mdを読んでください**
2. **各ドキュメントは承認済みの設計です** - 勝手に変更せず、ユーザーと合意してから変更してください
3. **CLAUDE.md のGitワークフロールールを必ず守ってください** - 特に master への直接 push は禁止です
4. **Issue作業時は issue-plan.md を参照してください** - 各Issueの詳細なタスクと成功基準が記載されています
5. **技術的な疑問は architecture.md と tech-selection.md を確認してください** - 設計の背景と理由が記載されています

---

## 📞 参考情報

### リポジトリ
- リポジトリ: `flutter_web_view`
- ブランチ戦略: CLAUDE.md 参照

### ドキュメント更新履歴
| 日付 | 内容 |
|------|------|
| 2025-11-30 | 初版作成（MVP要件定義、技術選定、アーキテクチャ、Issue計画） |

---

**Happy Coding! 🎉**
